services:
    wis2node:
      container_name: wis2node
      image: {{ setup_gb_antiloop_version }}
      env_file:
        - wis2node.env
        - redis.env
        - globalbroker.env
        - globalurl.env
        - host.env
      labels:
        - traefik.enable=true
        - traefik.http.routers.wis2node.entrypoints=websecure
        - traefik.http.routers.wis2node.service=wis2node-svc
        - traefik.http.routers.wis2node.middlewares=wis2node-strip,auth@file
        - traefik.http.routers.wis2node.rule=PathPrefix(`/wis2node/`)
        - "traefik.http.middlewares.wis2node-strip.stripprefix.prefixes=/wis2node"
        - traefik.http.services.wis2node-svc.loadbalancer.server.port=1880
        - traefik.http.services.wis2node-svc.loadbalancer.server.scheme=http
        - traefik.http.routers.wis2node.tls=true
      networks:
        - {{ docker_network_name }}
      restart: unless-stopped
networks:
    {{ docker_network_name }}:
      external: true